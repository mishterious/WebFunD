{"version":3,"sources":["webpack:///13.342828fe7f7c5ace7e85.js","webpack:///./components/logged_in.jsx"],"names":["webpackJsonp","1684","module","exports","__webpack_require__","_interopRequireWildcard","obj","__esModule","newObj","key","Object","prototype","hasOwnProperty","call","default","_interopRequireDefault","defineProperty","value","_getPrototypeOf","_getPrototypeOf2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_jquery","_jquery2","_propTypes","_propTypes2","_react","_react2","_reactRouter","_channels","_global_actions","GlobalActions","_websocket_actions","WebSocketActions","_user_store","_user_store2","_channel_store","_channel_store2","_error_store","_error_store2","_user_agent","UserAgent","_utils","Utils","_loading_screen","_loading_screen2","_route","_redux_store","_redux_store2","dispatch","getState","LoggedIn","_React$Component","params","this","_this","__proto__","onUserChanged","bind","state","user","getCurrentUser","document","getElementById","className","areObjectsEqual","setState","clearLastError","initialize","window","on","off","cookie","indexOf","viewChannel","getCurrentId","close","addChangeListener","addEventListener","onFocusListener","onBlurListener","isIos","addClass","isAndroid","attr","emitUserLoggedOutEvent","encodeURIComponent","props","location","pathname","ev","type","parent","prev","next","removeClass","closest","find","e","which","target","is","preventDefault","removeChangeListener","removeEventListener","isValidState","checkIfMFARequired","match","url","createElement","Redirect","to","children","emitBrowserFocus","Component","propTypes","object","1685","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0__MemoryRouter__","d","__WEBPACK_IMPORTED_MODULE_1__Prompt__","__WEBPACK_IMPORTED_MODULE_2__Redirect__","__WEBPACK_IMPORTED_MODULE_3__Route__","__WEBPACK_IMPORTED_MODULE_4__Router__","__WEBPACK_IMPORTED_MODULE_5__StaticRouter__","__WEBPACK_IMPORTED_MODULE_6__Switch__","__WEBPACK_IMPORTED_MODULE_7__matchPath__","__WEBPACK_IMPORTED_MODULE_8__withRouter__"],"mappings":"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","file":"13.342828fe7f7c5ace7e85.js","sourcesContent":["webpackJsonp([13],{\n\n/***/ 1684:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(239);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(238);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(242);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(240);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(241);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _jquery = __webpack_require__(708);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _propTypes = __webpack_require__(21);\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = __webpack_require__(13);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactRouter = __webpack_require__(1685);\n\nvar _channels = __webpack_require__(736);\n\nvar _global_actions = __webpack_require__(715);\n\nvar GlobalActions = _interopRequireWildcard(_global_actions);\n\nvar _websocket_actions = __webpack_require__(968);\n\nvar WebSocketActions = _interopRequireWildcard(_websocket_actions);\n\n__webpack_require__(772);\n\nvar _user_store = __webpack_require__(707);\n\nvar _user_store2 = _interopRequireDefault(_user_store);\n\nvar _channel_store = __webpack_require__(720);\n\nvar _channel_store2 = _interopRequireDefault(_channel_store);\n\nvar _error_store = __webpack_require__(779);\n\nvar _error_store2 = _interopRequireDefault(_error_store);\n\nvar _user_agent = __webpack_require__(725);\n\nvar UserAgent = _interopRequireWildcard(_user_agent);\n\nvar _utils = __webpack_require__(698);\n\nvar Utils = _interopRequireWildcard(_utils);\n\nvar _loading_screen = __webpack_require__(732);\n\nvar _loading_screen2 = _interopRequireDefault(_loading_screen);\n\nvar _route = __webpack_require__(1110);\n\nvar _redux_store = __webpack_require__(247);\n\nvar _redux_store2 = _interopRequireDefault(_redux_store);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Copyright (c) 2016-present Mattermost, Inc. All Rights Reserved.\n// See License.txt for license information.\n\nvar dispatch = _redux_store2.default.dispatch;\nvar getState = _redux_store2.default.getState;\n\nvar BACKSPACE_CHAR = 8;\n\nvar LoggedIn = function (_React$Component) {\n    (0, _inherits3.default)(LoggedIn, _React$Component);\n\n    function LoggedIn(params) {\n        (0, _classCallCheck3.default)(this, LoggedIn);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (LoggedIn.__proto__ || (0, _getPrototypeOf2.default)(LoggedIn)).call(this, params));\n\n        _this.onUserChanged = _this.onUserChanged.bind(_this);\n\n        _this.state = {\n            user: _user_store2.default.getCurrentUser()\n        };\n        document.getElementById('root').className += ' channel-view';\n        return _this;\n    }\n\n    (0, _createClass3.default)(LoggedIn, [{\n        key: 'isValidState',\n        value: function isValidState() {\n            return this.state.user != null;\n        }\n    }, {\n        key: 'onUserChanged',\n        value: function onUserChanged() {\n            // Grab the current user\n            var user = _user_store2.default.getCurrentUser();\n            if (!Utils.areObjectsEqual(this.state.user, user)) {\n                this.setState({\n                    user: user\n                });\n            }\n        }\n    }, {\n        key: 'componentWillMount',\n        value: function componentWillMount() {\n            _error_store2.default.clearLastError();\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            // Initialize websocket\n            WebSocketActions.initialize();\n\n            // Make sure the websockets close and reset version\n            (0, _jquery2.default)(window).on('beforeunload', function () {\n                // Turn off to prevent getting stuck in a loop\n                (0, _jquery2.default)(window).off('beforeunload');\n                if (document.cookie.indexOf('MMUSERID=') > -1) {\n                    (0, _channels.viewChannel)('', _channel_store2.default.getCurrentId() || '')(dispatch, getState);\n                }\n                WebSocketActions.close();\n            });\n\n            // Listen for user\n            _user_store2.default.addChangeListener(this.onUserChanged);\n\n            // Listen for focused tab/window state\n            window.addEventListener('focus', this.onFocusListener);\n            window.addEventListener('blur', this.onBlurListener);\n\n            // Because current CSS requires the root tag to have specific stuff\n\n            // Device tracking setup\n            if (UserAgent.isIos()) {\n                (0, _jquery2.default)('body').addClass('ios');\n            } else if (UserAgent.isAndroid()) {\n                (0, _jquery2.default)('body').addClass('android');\n            }\n\n            if (!this.state.user) {\n                (0, _jquery2.default)('#root').attr('class', '');\n                GlobalActions.emitUserLoggedOutEvent('/login?redirect_to=' + encodeURIComponent(this.props.location.pathname));\n            }\n\n            (0, _jquery2.default)('body').on('mouseenter mouseleave', '.post', function mouseOver(ev) {\n                if (ev.type === 'mouseenter') {\n                    (0, _jquery2.default)(this).parent('div').prev('.date-separator, .new-separator').addClass('hovered--after');\n                    (0, _jquery2.default)(this).parent('div').next('.date-separator, .new-separator').addClass('hovered--before');\n                } else {\n                    (0, _jquery2.default)(this).parent('div').prev('.date-separator, .new-separator').removeClass('hovered--after');\n                    (0, _jquery2.default)(this).parent('div').next('.date-separator, .new-separator').removeClass('hovered--before');\n                }\n            });\n\n            (0, _jquery2.default)('body').on('mouseenter mouseleave', '.search-item__container .post', function mouseOver(ev) {\n                if (ev.type === 'mouseenter') {\n                    (0, _jquery2.default)(this).closest('.search-item__container').find('.date-separator').addClass('hovered--after');\n                    (0, _jquery2.default)(this).closest('.search-item__container').next('div').find('.date-separator').addClass('hovered--before');\n                } else {\n                    (0, _jquery2.default)(this).closest('.search-item__container').find('.date-separator').removeClass('hovered--after');\n                    (0, _jquery2.default)(this).closest('.search-item__container').next('div').find('.date-separator').removeClass('hovered--before');\n                }\n            });\n\n            (0, _jquery2.default)('body').on('mouseenter mouseleave', '.post.post--comment.same--root', function mouseOver(ev) {\n                if (ev.type === 'mouseenter') {\n                    (0, _jquery2.default)(this).parent('div').prev('.date-separator, .new-separator').addClass('hovered--comment');\n                    (0, _jquery2.default)(this).parent('div').next('.date-separator, .new-separator').addClass('hovered--comment');\n                } else {\n                    (0, _jquery2.default)(this).parent('div').prev('.date-separator, .new-separator').removeClass('hovered--comment');\n                    (0, _jquery2.default)(this).parent('div').next('.date-separator, .new-separator').removeClass('hovered--comment');\n                }\n            });\n\n            // Prevent backspace from navigating back a page\n            (0, _jquery2.default)(window).on('keydown.preventBackspace', function (e) {\n                if (e.which === BACKSPACE_CHAR && !(0, _jquery2.default)(e.target).is('input, textarea')) {\n                    e.preventDefault();\n                }\n            });\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            WebSocketActions.close();\n            _user_store2.default.removeChangeListener(this.onUserChanged);\n\n            (0, _jquery2.default)('body').off('click.userpopover');\n            (0, _jquery2.default)('body').off('mouseenter mouseleave', '.post');\n            (0, _jquery2.default)('body').off('mouseenter mouseleave', '.post.post--comment.same--root');\n\n            (0, _jquery2.default)('.modal').off('show.bs.modal');\n\n            (0, _jquery2.default)(window).off('keydown.preventBackspace');\n\n            // Listen for focussed tab/window state\n            window.removeEventListener('focus', this.onFocusListener);\n            window.removeEventListener('blur', this.onBlurListener);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            if (!this.isValidState()) {\n                return _react2.default.createElement(_loading_screen2.default, null);\n            }\n\n            if (this.props.location.pathname !== '/mfa/setup' && (0, _route.checkIfMFARequired)(this.props.match.url)) {\n                return _react2.default.createElement(_reactRouter.Redirect, { to: '/mfa/setup' });\n            }\n\n            return this.props.children;\n        }\n    }, {\n        key: 'onFocusListener',\n        value: function onFocusListener() {\n            GlobalActions.emitBrowserFocus(true);\n        }\n    }, {\n        key: 'onBlurListener',\n        value: function onBlurListener() {\n            GlobalActions.emitBrowserFocus(false);\n        }\n    }]);\n    return LoggedIn;\n}(_react2.default.Component);\n\nexports.default = LoggedIn;\n\n\nLoggedIn.propTypes = {\n    children: _propTypes2.default.object\n};\n\n/***/ }),\n\n/***/ 1685:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__MemoryRouter__ = __webpack_require__(260);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"MemoryRouter\", function() { return __WEBPACK_IMPORTED_MODULE_0__MemoryRouter__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Prompt__ = __webpack_require__(261);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Prompt\", function() { return __WEBPACK_IMPORTED_MODULE_1__Prompt__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Redirect__ = __webpack_require__(262);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Redirect\", function() { return __WEBPACK_IMPORTED_MODULE_2__Redirect__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Route__ = __webpack_require__(167);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Route\", function() { return __WEBPACK_IMPORTED_MODULE_3__Route__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Router__ = __webpack_require__(110);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Router\", function() { return __WEBPACK_IMPORTED_MODULE_4__Router__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__StaticRouter__ = __webpack_require__(263);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"StaticRouter\", function() { return __WEBPACK_IMPORTED_MODULE_5__StaticRouter__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Switch__ = __webpack_require__(264);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Switch\", function() { return __WEBPACK_IMPORTED_MODULE_6__Switch__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__matchPath__ = __webpack_require__(111);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"matchPath\", function() { return __WEBPACK_IMPORTED_MODULE_7__matchPath__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__withRouter__ = __webpack_require__(265);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"withRouter\", function() { return __WEBPACK_IMPORTED_MODULE_8__withRouter__[\"a\"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 13.342828fe7f7c5ace7e85.js","// Copyright (c) 2016-present Mattermost, Inc. All Rights Reserved.\n// See License.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Redirect} from 'react-router';\nimport {viewChannel} from 'mattermost-redux/actions/channels';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport * as WebSocketActions from 'actions/websocket_actions.jsx';\nimport 'stores/emoji_store.jsx';\nimport UserStore from 'stores/user_store.jsx';\nimport ChannelStore from 'stores/channel_store.jsx';\nimport ErrorStore from 'stores/error_store.jsx';\nimport * as UserAgent from 'utils/user_agent.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport LoadingScreen from 'components/loading_screen.jsx';\nimport {checkIfMFARequired} from 'utils/route';\nimport store from 'stores/redux_store.jsx';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nconst BACKSPACE_CHAR = 8;\n\nexport default class LoggedIn extends React.Component {\n    constructor(params) {\n        super(params);\n\n        this.onUserChanged = this.onUserChanged.bind(this);\n\n        this.state = {\n            user: UserStore.getCurrentUser()\n        };\n        document.getElementById('root').className += ' channel-view';\n    }\n\n    isValidState() {\n        return this.state.user != null;\n    }\n\n    onUserChanged() {\n        // Grab the current user\n        const user = UserStore.getCurrentUser();\n        if (!Utils.areObjectsEqual(this.state.user, user)) {\n            this.setState({\n                user\n            });\n        }\n    }\n\n    componentWillMount() {\n        ErrorStore.clearLastError();\n    }\n\n    componentDidMount() {\n        // Initialize websocket\n        WebSocketActions.initialize();\n\n        // Make sure the websockets close and reset version\n        $(window).on('beforeunload',\n            () => {\n                // Turn off to prevent getting stuck in a loop\n                $(window).off('beforeunload');\n                if (document.cookie.indexOf('MMUSERID=') > -1) {\n                    viewChannel('', ChannelStore.getCurrentId() || '')(dispatch, getState);\n                }\n                WebSocketActions.close();\n            }\n        );\n\n        // Listen for user\n        UserStore.addChangeListener(this.onUserChanged);\n\n        // Listen for focused tab/window state\n        window.addEventListener('focus', this.onFocusListener);\n        window.addEventListener('blur', this.onBlurListener);\n\n        // Because current CSS requires the root tag to have specific stuff\n\n        // Device tracking setup\n        if (UserAgent.isIos()) {\n            $('body').addClass('ios');\n        } else if (UserAgent.isAndroid()) {\n            $('body').addClass('android');\n        }\n\n        if (!this.state.user) {\n            $('#root').attr('class', '');\n            GlobalActions.emitUserLoggedOutEvent('/login?redirect_to=' + encodeURIComponent(this.props.location.pathname));\n        }\n\n        $('body').on('mouseenter mouseleave', '.post', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).parent('div').prev('.date-separator, .new-separator').addClass('hovered--after');\n                $(this).parent('div').next('.date-separator, .new-separator').addClass('hovered--before');\n            } else {\n                $(this).parent('div').prev('.date-separator, .new-separator').removeClass('hovered--after');\n                $(this).parent('div').next('.date-separator, .new-separator').removeClass('hovered--before');\n            }\n        });\n\n        $('body').on('mouseenter mouseleave', '.search-item__container .post', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).closest('.search-item__container').find('.date-separator').addClass('hovered--after');\n                $(this).closest('.search-item__container').next('div').find('.date-separator').addClass('hovered--before');\n            } else {\n                $(this).closest('.search-item__container').find('.date-separator').removeClass('hovered--after');\n                $(this).closest('.search-item__container').next('div').find('.date-separator').removeClass('hovered--before');\n            }\n        });\n\n        $('body').on('mouseenter mouseleave', '.post.post--comment.same--root', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).parent('div').prev('.date-separator, .new-separator').addClass('hovered--comment');\n                $(this).parent('div').next('.date-separator, .new-separator').addClass('hovered--comment');\n            } else {\n                $(this).parent('div').prev('.date-separator, .new-separator').removeClass('hovered--comment');\n                $(this).parent('div').next('.date-separator, .new-separator').removeClass('hovered--comment');\n            }\n        });\n\n        // Prevent backspace from navigating back a page\n        $(window).on('keydown.preventBackspace', (e) => {\n            if (e.which === BACKSPACE_CHAR && !$(e.target).is('input, textarea')) {\n                e.preventDefault();\n            }\n        });\n    }\n\n    componentWillUnmount() {\n        WebSocketActions.close();\n        UserStore.removeChangeListener(this.onUserChanged);\n\n        $('body').off('click.userpopover');\n        $('body').off('mouseenter mouseleave', '.post');\n        $('body').off('mouseenter mouseleave', '.post.post--comment.same--root');\n\n        $('.modal').off('show.bs.modal');\n\n        $(window).off('keydown.preventBackspace');\n\n        // Listen for focussed tab/window state\n        window.removeEventListener('focus', this.onFocusListener);\n        window.removeEventListener('blur', this.onBlurListener);\n    }\n\n    render() {\n        if (!this.isValidState()) {\n            return <LoadingScreen/>;\n        }\n\n        if (this.props.location.pathname !== '/mfa/setup' && checkIfMFARequired(this.props.match.url)) {\n            return <Redirect to={'/mfa/setup'}/>;\n        }\n\n        return this.props.children;\n    }\n\n    onFocusListener() {\n        GlobalActions.emitBrowserFocus(true);\n    }\n\n    onBlurListener() {\n        GlobalActions.emitBrowserFocus(false);\n    }\n}\n\nLoggedIn.propTypes = {\n    children: PropTypes.object\n};\n\n\n\n// WEBPACK FOOTER //\n// ./components/logged_in.jsx"],"sourceRoot":""}